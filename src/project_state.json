{
  "schemaVersion": "1.0.0",
  "projectStateVersion": 15,
  "summary": "ICP canister-based web app scaffolded with Motoko backend and React/Vite frontend, including Internet Identity authentication, core UI shell/branding, and initial Customers and Invoices CRUD-style pages.",
  "existing_features": [
    {
      "id": "IF-1",
      "title": "Motoko backend canister scaffold",
      "synonyms": [
        "backend canister",
        "Motoko service"
      ],
      "description": "Initial Motoko backend setup with candid bindings and project build/deploy configuration for ICP.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-2",
      "title": "React + Vite frontend scaffold",
      "synonyms": [
        "frontend app shell",
        "Vite React app"
      ],
      "description": "Frontend application scaffold including routing/layout shell, Tailwind setup, and build tooling.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-3",
      "title": "Internet Identity authentication integration",
      "synonyms": [
        "II auth",
        "Internet Identity login"
      ],
      "description": "Client hooks and configuration to authenticate users via Internet Identity and create an authenticated actor for backend calls.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-4",
      "title": "Backend client + typed declarations",
      "synonyms": [
        "backendClient",
        "candid typings"
      ],
      "description": "Typed frontend bindings and client utilities for calling the backend canister (generated .did JS/TS and helper client).",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-5",
      "title": "App shell with branding assets",
      "synonyms": [
        "BrandHeader",
        "AppShell"
      ],
      "description": "Core UI shell components and generated brand images (logo, header banner, icons) wired into the frontend.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-6",
      "title": "Shadcn UI component library integrated",
      "synonyms": [
        "shadcn/ui",
        "UI primitives"
      ],
      "description": "Large set of reusable UI primitives (buttons, dialogs, forms, tables, etc.) added to the frontend component library.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-7",
      "title": "Customers feature pages and form",
      "synonyms": [
        "CustomersPage",
        "CustomerForm"
      ],
      "description": "Initial Customers feature implementation including types, queries, list page and create/edit form UI.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-8",
      "title": "Invoices feature pages and editor",
      "synonyms": [
        "InvoicesPage",
        "InvoiceForm",
        "InvoiceDetailPage"
      ],
      "description": "Initial Invoices feature implementation including list/detail pages, invoice form, and line item editor UI with types and queries.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-9",
      "title": "Client-side query key and storage utilities",
      "synonyms": [
        "queryKeys",
        "StorageClient"
      ],
      "description": "Shared utilities for stable query keys and local/persistent client storage helpers used across features.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "IF-10",
      "title": "Build template and deployment scripts",
      "synonyms": [
        "build-template",
        "Dockerfile",
        "deploy.sh"
      ],
      "description": "Project build template files (Dockerfile, scripts, workspace config, ICP yaml/canister configs) to support repeatable builds and deployment.",
      "reqIds": [],
      "version": 1
    },
    {
      "id": "feature-investigate-and-fix-the-runtime-loading-error-that-prevents-the-react-app-from-rendering-prioritizing-startup-time-crashes-in-the-authentication-bootstrap-layer-e-g-internet-identity-provider-initialization-ensure-the-app-loads-to-the-main-route-without-a-blank-screen-or-uncaught-exception",
      "title": "Investigate and fix the runtime “loading error” that prevents the React app from rendering, prioritizing startup-time crashes in the authentication/bootstrap layer (e.g., Internet Identity provider initialization). Ensure the app loads to the main route without a blank screen or uncaught exception.",
      "reqIds": [
        "REQ-1"
      ],
      "version": 1
    },
    {
      "id": "feature-remove-replace-any-node-only-environment-access-that-can-crash-in-the-browser-notably-process-env-usage-in-the-frontend-specifically-ensure-internet-identity-configuration-does-not-reference-process-env-at-runtime-in-vite-react-and-provide-a-safe-fallback-identity-provider-url-when-configuration-is-missing",
      "title": "Remove/replace any Node-only environment access that can crash in the browser (notably `process.env` usage in the frontend). Specifically ensure Internet Identity configuration does not reference `process.env.*` at runtime in Vite/React, and provide a safe fallback identity provider URL when configuration is missing.",
      "reqIds": [
        "REQ-2"
      ],
      "version": 1
    },
    {
      "id": "feature-add-a-user-visible-non-crashing-error-presentation-for-initialization-authentication-failures-so-users-are-not-stuck-on-an-indefinite-loading-state-reuse-existing-ui-patterns-e-g-asyncstate-to-show-an-actionable-message-and-retry-guidance-when-initialization-fails",
      "title": "Add a user-visible, non-crashing error presentation for initialization/authentication failures so users are not stuck on an indefinite loading state. Reuse existing UI patterns (e.g., `AsyncState`) to show an actionable message and retry guidance when initialization fails.",
      "reqIds": [
        "REQ-3"
      ],
      "version": 1
    }
  ],
  "new_feature_requests": [],
  "architectural_notes": [
    "Frontend uses React + Vite with Tailwind and shadcn/ui component primitives.",
    "Authentication is handled via Internet Identity; frontend creates an authenticated canister actor for API calls.",
    "Feature structure introduced for Customers and Invoices with colocated types/queries/components.",
    "Typed canister bindings (.did JS/TS) are included for frontend-backend integration.",
    "Build/deploy templating added (Dockerfile/scripts/icp yaml) for reproducible ICP builds.",
    "Build template expanded to include full React/Vite + Tailwind + shadcn/ui starter with ICP canister configs and workspace packaging.",
    "Custom frontend ESLint rules added to enforce stable query keys (no bigint) and required Internet Identity provider configuration.",
    "Image asset tooling added (resize/prune scripts) for generated branding assets in the build template."
  ],
  "known_issues": [
    "App has a loading error that needs to be investigated and fixed (details not provided)."
  ],
  "isFixRequest": true,
  "generatedImages": [
    {
      "filename": "frontend/public/assets/generated/queen-bee-app-icon.dim_180x180.png",
      "description": "Generated app icon asset",
      "targetWidth": 180,
      "targetHeight": 180
    },
    {
      "filename": "frontend/public/assets/generated/queen-bee-favicon.dim_32x32.png",
      "description": "Generated favicon asset",
      "targetWidth": 32,
      "targetHeight": 32
    },
    {
      "filename": "frontend/public/assets/generated/queen-bee-favicon.dim_48x48.png",
      "description": "Generated favicon asset",
      "targetWidth": 48,
      "targetHeight": 48
    }
  ],
  "projectName": "Fix app loading error on startup",
  "clarification_mode": "instant",
  "clarification_rounds": 0
}